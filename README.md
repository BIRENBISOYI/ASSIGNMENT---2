# ASSIGNMENT---2
üìò FinSecure Loan Default Prediction ‚Äî README
üìå Project Background

FinSecure is a peer-to-peer lending platform that connects borrowers with investors.
The business depends heavily on accurately predicting loan repayment risk. A loan that is not paid back (default) results in financial losses for investors and reduces trust in the marketplace.

Historically, loan approvals were made using a manual, rule-based scorecard, which is slow and unable to capture non-linear patterns in borrower behavior.
The goal of this project is to build a data-driven machine learning model that predicts whether a loan will be paid back (1) or default (0).

üéØ Objective

Build and evaluate a supervised machine learning model to:

Predict loan default probability (loan_paid_back)

Maximize ROC AUC (primary metric)

Ensure fairness across subgroups, especially:

education_level

loan_purpose (top 3 and bottom 3 purposes by AUC)

This outputs:

A predictive model for operational decision-making

Subgroup fairness analysis

Test-set probability predictions

üìÇ Dataset Description

The dataset used is:

loan_data.csv

Key columns:
Column	Description
id	Loan application ID
annual_income	Borrower's annual income
debt_to_income_ratio	Total debt divided by income
credit_score	Borrower credit rating
loan_amount	Requested loan amount
interest_rate	Assigned loan interest rate
gender	Borrower's gender
marital_status	Marital status
education_level	Highest education level
employment_status	Current employment
loan_purpose	Reason for loan (e.g. debt consolidation)
grade, subgrade	Risk assessment tiers
loan_paid_back	Target variable (1 = paid back, 0 = default)
üõ†Ô∏è Methodology Summary
1. Problem Formulation & Target Analysis

We treat loan_paid_back = 0 as a default event.

This is a binary classification problem predicting risk of default.

2. Preprocessing & Feature Engineering

The pipeline handles:

‚úî Missing values
‚úî One-hot encoding for categorical variables
‚úî Standard scaling for numeric variables
‚úî Train/test split with stratification
‚úî End-to-end scikit-learn pipeline for reproducibility

3. Model Development

Two model families were trained:

Logistic Regression

Random Forest

A small hyperparameter grid search was run using:

GridSearchCV
5-fold Stratified CV
Metric: ROC AUC


The model with the highest test ROC AUC is selected as the final model.

4. Predictions

The final model outputs:

Probabilities of repayment (pred_proba)

Saved as:

loan_test_predictions.csv

5. Subgroup Fairness Analysis

AUC is computed for:

a) By education_level

AUC for every level present in the test data.

b) By loan_purpose

Purpose categories with >= 30 samples are ranked:

Top 3 performing purposes

Bottom 3 performing purposes

Ensures the model does not unfairly penalize certain borrower groups.

üìà Evaluation Metric: Why AUC?

ROC AUC is used because:

It is threshold-independent

Measures ability to rank defaults vs non-defaults

Robust to class imbalance

Critical for deciding loan approvals (cost-sensitive decisions)

‚ñ∂Ô∏è How to Run in Google Colab

Open a new notebook in Google Colab

Copy the full training script provided in this repository

Upload loan_data.csv when prompted

Run all cells

Download:

loan_test_predictions.csv    # model output
AUC tables and plots         # subgroup analysis

üì§ Output Files
File	Description
loan_test_predictions.csv	Test-set probabilities generated by the selected model
roc_curve.png	ROC curve plot for the final model
subgroup_auc_tables	AUC breakdown for education level & loan purpose
üß† Key Insights Provided

Which borrower attributes correlate most with default risk

Which loan purposes/education levels perform poorly

Distribution of predicted risk scores

Model strengths & limitations

üîö Conclusion

This experiment delivers a complete, fairness-aware ML solution for FinSecure‚Äôs loan approval process.
It replaces subjective decision rules with a quantitative risk score, enabling:

Faster loan approvals

Better investor protection

Transparent and fair underwriting decisions
